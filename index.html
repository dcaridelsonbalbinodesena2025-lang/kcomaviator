<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aviator Pro - AutomÃ¡tico</title>
    <style>
        :root { --verde: #27ae60; --vermelho: #c0392b; --azul: #3498db; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Arial Black', sans-serif; }
        body { background: #000; color: white; display: flex; flex-direction: column; align-items: center; padding: 10px; }
        .calculadora { width: 100%; max-width: 450px; background: #1a1a1a; border-radius: 20px; border: 2px solid #333; padding: 15px; }
        .status-topo { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; }
        .grade { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 15px; }
        .vela { background: #333; height: 35px; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: bold; }
        .v-azul { background: #003247; } .v-roxo { background: #6441a5; } .v-rosa { background: #bf279b; }
        .visor { background: #000; height: 60px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--verde); border: 1px solid #444; margin-bottom: 15px; }
        .teclado { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .btn { background: #333; color: white; border: none; padding: 15px; border-radius: 10px; font-size: 1.5rem; font-weight: bold; }
        .btn-c { background: var(--vermelho); }
        .btn-g { background: var(--verde); grid-column: span 2; }
    </style>
</head>
<body onload="iniciar()">
    <div class="calculadora">
        <div class="status-topo">
            <span style="color:var(--verde)">G: 0</span>
            <span id="robo-status" style="color: #888;">ðŸ“¡ CONECTANDO...</span>
            <span style="color:var(--vermelho)">R: 0</span>
        </div>
        <div class="grade" id="grade"></div>
        <div class="visor" id="visor-val">0.00</div>
        <div class="teclado">
            <button class="btn" onclick="add('7')">7</button><button class="btn" onclick="add('8')">8</button><button class="btn" onclick="add('9')">9</button>
            <button class="btn" onclick="add('4')">4</button><button class="btn" onclick="add('5')">5</button><button class="btn" onclick="add('6')">6</button>
            <button class="btn" onclick="add('1')">1</button><button class="btn" onclick="add('2')">2</button><button class="btn" onclick="add('3')">3</button>
            <button class="btn-c" onclick="limpar()">C</button><button class="btn-g" onclick="confirmar()">ENTRAR</button>
        </div>
    </div>

<script>
    let historico = [], digitacao = "", ultimoValor = 0;
    const URL = 'https://kcomaviator.onrender.com/ultimo';

    async function monitorar() {
        try {
            const res = await fetch(URL);
            const data = await res.json();
            document.getElementById('robo-status').innerText = "ðŸŸ¢ ONLINE";
            if (data.valor !== ultimoValor && data.valor > 0) {
                processar(data.valor);
                ultimoValor = data.valor;
            }
        } catch (e) {
            document.getElementById('robo-status').innerText = "ðŸ”´ ACORDANDO SERVIDOR...";
        }
    }

    function processar(v) {
        const cl = v < 2.0 ? 'v-azul' : (v < 10.0 ? 'v-roxo' : 'v-rosa');
        historico.unshift({v: v.toFixed(2), cl: cl});
        if(historico.length > 21) historico.pop();
        document.getElementById('visor-val').innerText = v.toFixed(2);
        render();
    }

    function render() {
        const g = document.getElementById('grade');
        g.innerHTML = '';
        for(let i=0; i<21; i++) {
            const item = historico[i];
            g.innerHTML += `<div class="vela ${item ? item.cl : ''}">${item ? item.v : ''}</div>`;
        }
    }

    function add(n) { digitacao += n; document.getElementById('visor-val').innerText = digitacao; }
    function limpar() { digitacao = ""; document.getElementById('visor-val').innerText = "0.00"; }
    function confirmar() { if(digitacao) processar(parseFloat(digitacao)); limpar(); }
    function iniciar() { render(); setInterval(monitorar, 3000); }
</script>
</body>
</html>
